#!/bin/bash

# Update
apt update

# Install Dependencies
apt install -y python python-pip

# Install venv
python -m pip install virtualenv

# Clone the repository
git clone https://github.com/AonCyberLabs/Windows-Exploit-Suggester /opt/Windows-Exploit-Suggester

# Create the python venv
python -m virtualenv -p /usr/bin/python2.7 /opt/Windows-Exploit-Suggester/venv

# Source the python venv
source /opt/Windows-Exploit-Suggester/venv/bin/activate

# Install python dependencies
python -m pip install xlrd

# Exit the venv
deactivate

# Create the bash script
echo '/opt/Windows-Exploit-Suggester/venv/bin/python /opt/Windows-Exploit-Suggester/windows-exploit-suggester.py "$@"' > /root/.local/bin/Windows-Exploit-Suggester

# Make executable
chmod +x /root/.local/bin/Windows-Exploit-Suggester
